<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %></title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body { font-family:'Roboto', sans-serif; background:#f5f6fa; margin:0; color:#333; }

    /* --- Header existant --- */
    header { 
      background:linear-gradient(90deg,#4b6cb7,#182848);
      padding:15px 30px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      position:sticky;
      top:0;
      z-index:1000;
      flex-wrap:wrap;
    }
    header h1 { color:#fff; font-size:1.8rem; margin-bottom:10px; }
    nav { display:flex; flex-wrap:wrap; align-items:center; }
    nav a { margin:5px 10px; color:#fff; text-decoration:none; font-weight:500; position:relative; white-space:nowrap; }
    nav a:hover::after { content:""; position:absolute; width:100%; height:2px; background:#fff; bottom:-3px; left:0; }

    /* --- Container produit --- */
    .container { max-width:1100px; margin:40px auto; padding:20px; background:#fff; border-radius:15px; box-shadow:0 4px 20px rgba(0,0,0,0.1); display:flex; flex-wrap:wrap; gap:30px; }

    /* --- Carrousel --- */
    .carousel { flex:1 1 500px; }
    .carousel-main { border-radius:15px; overflow:hidden; }
    .carousel-main img { width:100%; max-height:500px; object-fit:cover; transition: transform 0.3s; }
    .carousel-main img:hover { transform:scale(1.05); }
    .thumbnails { display:flex; gap:10px; margin-top:10px; justify-content:center; }
    .thumbnails img { width:80px; height:80px; object-fit:cover; border-radius:8px; cursor:pointer; border:2px solid transparent; transition: border 0.3s; }
    .thumbnails img.active { border-color:#4b6cb7; }

    /* --- Infos produit --- */
    .product-info { flex:1 1 500px; display:flex; flex-direction:column; gap:15px; }
    .product-info h2 { color:#4b6cb7; font-size:2rem; margin-bottom:5px; }
    .price { font-size:1.6rem; font-weight:bold; color:#e74c3c; }
    .stock { font-weight:500; color:#27ae60; }
    .details { display:grid; grid-template-columns:1fr 1fr; gap:10px; }
    .details p { margin:0; font-size:1rem; }
    .features { display:flex; flex-wrap:wrap; gap:8px; margin-top:10px; }
    .features span { background:#e0e7ff; color:#1e3c72; padding:6px 12px; border-radius:20px; font-size:0.9rem; }

    .description { margin-top:20px; padding-top:15px; border-top:1px solid #ddd; }
    .description h3 { margin-bottom:10px; color:#4b6cb7; }
    .description p { line-height:1.6; }

    .actions { display:flex; gap:15px; margin-top:20px; }
    .actions a, .actions button { flex:1; text-align:center; padding:12px; border-radius:8px; font-weight:bold; text-decoration:none; color:#fff; cursor:pointer; transition:0.3s; }
    .btn-back { background:#777; }
    .btn-pay { background:#4b6cb7; }
    .btn-pay:hover { background:#1e3c72; }

    /* --- Footer existant --- */
    footer { background:#182848; color:#fff; text-align:center; padding:40px 20px; margin-top:50px; }
    footer a { color:#4b6cb7; margin:0 8px; text-decoration:none; font-weight:500; }
    footer a:hover { text-decoration:underline; }

    @media (max-width:768px){ .container { flex-direction:column; } }
  </style>
</head>
<body>

  <!-- Header existant -->
  <header>
    <h1>üõçÔ∏è Karla Shopping</h1>
    <nav>
      <a href="/">Accueil</a>
      <a href="/products">Produits</a>
      <% if (session.user) { %>
        <span style="color:#fff; margin:0 10px;">Membre actif</span>
        <a href="/logout">D√©connexion</a>
        <% if (session.isAdmin) { %><a href="/upload">Upload</a><% } %>
      <% } else { %>
        <a href="#" id="btnLogin">Connexion</a>
        <a href="#" id="btnSignup">Cr√©er un compte</a>
      <% } %>
    </nav>
  </header>

  <!-- Container produit -->
  <div class="container">
    <!-- Carrousel images -->
    <div class="carousel">
      <div class="carousel-main">
        <img id="mainImage" src="<%= product.main_image_url %>" alt="<%= product.title %>">
      </div>
      <div class="thumbnails">
        <img class="active" src="<%= product.main_image_url %>" alt="main" onclick="changeImage(this)">
        <% if (product.secondary_image_urls) { 
             JSON.parse(product.secondary_image_urls).forEach(sec => { %>
           <img src="<%= sec.url %>" alt="secondary" onclick="changeImage(this)">
        <% }) } %>
      </div>
    </div>

    <!-- Infos produit -->
    <div class="product-info">
      <h2><%= product.title %></h2>
      <p class="price">‚Ç¨<%= product.price %></p>
      <p class="stock"><i class="fa-solid fa-check"></i> Disponible</p>

      <div class="details">
        <p><strong>Marque :</strong> <%= product.brand %></p>
        <p><strong>Quantit√© :</strong> <%= product.quantity %></p>
        <p><strong>Cat√©gorie :</strong> <%= product.category %></p>
        <p><strong>Condition :</strong> <%= product.condition %></p>
        <p><strong>Localisation :</strong> <%= product.location %></p>
        <p><strong>Livraison :</strong> <%= product.delivery %></p>
      </div>

      <div class="features">
        <% if(product.features) { product.features.split(',').forEach(f => { %>
          <span><i class="fa-solid fa-circle-check"></i> <%= f.trim() %></span>
        <% }) } %>
      </div>

      <div class="description">
        <h3>Description</h3>
        <p><%= product.description %></p>
      </div>

      <div class="actions">
        <a href="/" class="btn-back"><i class="fa-solid fa-arrow-left"></i> Retour</a>
        <a href="/payment/<%= product.id %>" class="btn-pay"><i class="fa-solid fa-cart-shopping"></i> Acheter</a>
      </div>
    </div>
  </div>

  <!-- Footer existant -->
  <footer>
    <p>¬© 2024 Karla Shopping - Tous droits r√©serv√©s</p>
    <div>
      <a href="#">Facebook</a>
      <a href="#">Instagram</a>
      <a href="#">Twitter</a>
    </div>
  </footer>

  <script>
    function changeImage(img){
      document.getElementById('mainImage').src = img.src;
      document.querySelectorAll('.thumbnails img').forEach(i => i.classList.remove('active'));
      img.classList.add('active');
    }
  </script>

</body>
</html>
